
>> Sending IPMI command payload
>>    netfn   : 0x06
>>    command : 0x38
>>    data    : 0x8e 0x04 

BUILDING A v1.5 COMMAND
added list entry seq=0x00 cmd=0x38
>> IPMI Request Session Header
>>   Authtype   : NONE
>>   Sequence   : 0x00000000
>>   Session ID : 0x00000000
>> IPMI Request Message Header
>>   Rs Addr    : 20
>>   NetFn      : 06
>>   Rs LUN     : 0
>>   Rq Addr    : 81
>>   Rq Seq     : 00
>>   Rq Lun     : 0
>>   Command    : 38
>> sending packet (23 bytes)
 06 00 ff 07 00 00 00 00 00 00 00 00 00 09 20 18
 c8 81 00 38 8e 04 b5
<< received packet (30 bytes)
 06 00 ff 07 00 00 00 00 00 00 00 00 00 10 81 1c
 63 20 00 38 00 01 97 04 03 00 00 00 00 09
<< IPMI Response Session Header
<<   Authtype                : NONE
<<   Payload type            : IPMI (0)
<<   Session ID              : 0x00000000
<<   Sequence                : 0x00000000
<<   IPMI Msg/Payload Length : 16
<< IPMI Response Message Header
<<   Rq Addr    : 81
<<   NetFn      : 07
<<   Rq LUN     : 0
<<   Rs Addr    : 20
<<   Rq Seq     : 00
<<   Rs Lun     : 0
<<   Command    : 38
<<   Compl Code : 0x00
IPMI Request Match found
removed list entry seq=0x00 cmd=0x38
>> SENDING AN OPEN SESSION REQUEST

>> sending packet (48 bytes)
 06 00 ff 07 06 10 00 00 00 00 00 00 00 00 20 00
 00 00 00 00 a4 a3 a2 a0 00 00 00 08 01 00 00 00
 01 00 00 08 01 00 00 00 02 00 00 08 00 00 00 00
<< received packet (52 bytes)
 06 00 ff 07 06 11 00 00 00 00 00 00 00 00 24 00
 00 00 00 00 a4 a3 a2 a0 82 06 00 00 00 00 00 08
 01 00 00 00 01 00 00 08 01 00 00 00 02 00 00 08
 00 00 00 00
>> Console generated random number (16 bytes)
 86 e2 b2 f1 10 b3 ff 8d 63 cf ad a4 c0 6e bd 1a
>> SENDING A RAKP 1 MESSAGE

>> sending packet (49 bytes)
 06 00 ff 07 06 12 00 00 00 00 00 00 00 00 21 00
 00 00 00 00 82 06 00 00 86 e2 b2 f1 10 b3 ff 8d
 63 cf ad a4 c0 6e bd 1a 14 00 00 05 41 44 4d 49
 4e
<< received packet (76 bytes)
 06 00 ff 07 06 13 00 00 00 00 00 00 00 00 3c 00
 00 00 00 00 a4 a3 a2 a0 b8 91 42 54 44 0e d6 81
 44 02 82 7c a3 e8 8a cf a1 23 45 67 89 ab cd ef
 a1 23 45 67 89 ab cd ef 87 9b 65 cd bc ab ab 5b
 f8 b9 45 c7 30 76 4c 91 3e 8d 2b 9a
bmc_rand (16 bytes)
 b8 91 42 54 44 0e d6 81 44 02 82 7c a3 e8 8a cf
>> rakp2 mac input buffer (63 bytes)
 a4 a3 a2 a0 82 06 00 00 86 e2 b2 f1 10 b3 ff 8d
 63 cf ad a4 c0 6e bd 1a b8 91 42 54 44 0e d6 81
 44 02 82 7c a3 e8 8a cf a1 23 45 67 89 ab cd ef
 a1 23 45 67 89 ab cd ef 14 05 41 44 4d 49 4e
>> rakp2 mac key (20 bytes)
 41 44 4d 49 4e 00 00 00 00 00 00 00 00 00 00 00
 00 00 00 00
>> rakp2 mac as computed by the remote console (20 bytes)
 87 9b 65 cd bc ab ab 5b f8 b9 45 c7 30 76 4c 91
 3e 8d 2b 9a
>> rakp3 mac input buffer (27 bytes)
 b8 91 42 54 44 0e d6 81 44 02 82 7c a3 e8 8a cf
 a4 a3 a2 a0 14 05 41 44 4d 49 4e
>> rakp3 mac key (20 bytes)
 41 44 4d 49 4e 00 00 00 00 00 00 00 00 00 00 00
 00 00 00 00
generated rakp3 mac (20 bytes)
 df 67 52 fb ed c2 2a c3 99 82 5e 06 d3 2c ba 71
 7b 41 20 be
session integrity key input (39 bytes)
 86 e2 b2 f1 10 b3 ff 8d 63 cf ad a4 c0 6e bd 1a
 b8 91 42 54 44 0e d6 81 44 02 82 7c a3 e8 8a cf
 14 05 41 44 4d 49 4e
Generated session integrity key (20 bytes)
 38 b5 8a 90 09 53 16 b3 2b 85 0d 0e 21 de 82 c1
 fa ce de 15
Generated K1 (20 bytes)
 65 18 bc 15 d1 20 9c 49 77 79 a0 83 61 c1 15 58
 39 bd f1 74
Generated K2 (20 bytes)
 25 26 80 06 c3 77 4a a8 9d dd 05 58 ae 17 cc dc
 69 71 da ee
>> SENDING A RAKP 3 MESSAGE

>> sending packet (44 bytes)
 06 00 ff 07 06 14 00 00 00 00 00 00 00 00 1c 00
 00 00 00 00 82 06 00 00 df 67 52 fb ed c2 2a c3
 99 82 5e 06 d3 2c ba 71 7b 41 20 be
<< received packet (36 bytes)
 06 00 ff 07 06 15 00 00 00 00 00 00 00 00 14 00
 00 00 00 00 a4 a3 a2 a0 e1 61 4f 85 ff b0 08 63
 8b 80 6c 99
>> rakp4 mac input buffer (36 bytes)
 86 e2 b2 f1 10 b3 ff 8d 63 cf ad a4 c0 6e bd 1a
 82 06 00 00 a1 23 45 67 89 ab cd ef a1 23 45 67
 89 ab cd ef
>> rakp4 mac key (sik) (20 bytes)
 38 b5 8a 90 09 53 16 b3 2b 85 0d 0e 21 de 82 c1
 fa ce de 15
>> rakp4 mac as computed by the BMC (20 bytes)
 e1 61 4f 85 ff b0 08 63 8b 80 6c 99 a3 e8 8a cf
 a1 23 45 67
>> rakp4 mac as computed by the remote console (20 bytes)
 e1 61 4f 85 ff b0 08 63 8b 80 6c 99 99 5e 43 0d
 af 05 c8 bc
IPMIv2 / RMCP+ SESSION OPENED SUCCESSFULLY


>> Sending IPMI command payload
>>    netfn   : 0x06
>>    command : 0x3b
>>    data    : 0x04 

BUILDING A v2 COMMAND
added list entry seq=0x01 cmd=0x3b
Local RqAddr 0x20 transit 0:0 target 0x20:0 bridgePossible 0
authcode input (24 bytes)
 06 40 82 06 00 00 03 00 00 00 08 00 20 18 c8 81
 04 3b 04 3c ff ff 02 07
authcode output (12 bytes)
 61 ff e9 60 e6 5a 56 3c ac 5d 28 5a
>> sending packet (40 bytes)
 06 00 ff 07 06 40 82 06 00 00 03 00 00 00 08 00
 20 18 c8 81 04 3b 04 3c ff ff 02 07 61 ff e9 60
 e6 5a 56 3c ac 5d 28 5a
<< received packet (40 bytes)
 06 00 ff 07 06 40 a4 a3 a2 a0 01 00 00 00 09 00
 81 1c 63 20 04 3b 00 04 9d ff 01 07 ee 45 1a 34
 ce 46 76 5d 38 49 1e 0a
Validating authcode
K1 (20 bytes)
 65 18 bc 15 d1 20 9c 49 77 79 a0 83 61 c1 15 58
 39 bd f1 74
Authcode Input Data (24 bytes)
 06 40 a4 a3 a2 a0 01 00 00 00 09 00 81 1c 63 20
 04 3b 00 04 9d ff 01 07
Generated authcode (20 bytes)
 ee 45 1a 34 ce 46 76 5d 38 49 1e 0a be 57 44 f1
 51 a6 67 86
Expected authcode (12 bytes)
 ee 45 1a 34 ce 46 76 5d 38 49 1e 0a
<< IPMI Response Session Header
<<   Authtype                : RMCP+
<<   Payload type            : IPMI (0)
<<   Session ID              : 0xa0a2a3a4
<<   Sequence                : 0x00000001
<<   IPMI Msg/Payload Length : 9
<< IPMI Response Message Header
<<   Rq Addr    : 81
<<   NetFn      : 07
<<   Rq LUN     : 0
<<   Rs Addr    : 20
<<   Rq Seq     : 01
<<   Rs Lun     : 0
<<   Command    : 3b
<<   Compl Code : 0x00
IPMI Request Match found
removed list entry seq=0x01 cmd=0x3b
set_session_privlvl (1 bytes)
 04
Set Session Privilege Level to ADMINISTRATOR


>> Sending IPMI command payload
>>    netfn   : 0x2c
>>    command : 0x3e
>>    data    : 0x00 0x02 

BUILDING A v2 COMMAND
added list entry seq=0x02 cmd=0x3e
Local RqAddr 0x20 transit 0:0 target 0x20:0 bridgePossible 0
authcode input (24 bytes)
 06 40 82 06 00 00 04 00 00 00 09 00 20 b0 30 81
 08 3e 00 02 37 ff 01 07
authcode output (12 bytes)
 dc 31 52 55 c2 e2 a7 99 d9 4c 29 b2
>> sending packet (40 bytes)
 06 00 ff 07 06 40 82 06 00 00 04 00 00 00 09 00
 20 b0 30 81 08 3e 00 02 37 ff 01 07 dc 31 52 55
 c2 e2 a7 99 d9 4c 29 b2
<< received packet (40 bytes)
 06 00 ff 07 06 40 a4 a3 a2 a0 02 00 00 00 08 00
 81 b4 cb 20 08 3e c1 d9 ff ff 02 07 a0 0c 8b 4a
 fb fb 87 3b b9 aa 6b 02
Validating authcode
K1 (20 bytes)
 65 18 bc 15 d1 20 9c 49 77 79 a0 83 61 c1 15 58
 39 bd f1 74
Authcode Input Data (24 bytes)
 06 40 a4 a3 a2 a0 02 00 00 00 08 00 81 b4 cb 20
 08 3e c1 d9 ff ff 02 07
Generated authcode (20 bytes)
 a0 0c 8b 4a fb fb 87 3b b9 aa 6b 02 e7 c8 df f5
 f8 43 53 bb
Expected authcode (12 bytes)
 a0 0c 8b 4a fb fb 87 3b b9 aa 6b 02
<< IPMI Response Session Header
<<   Authtype                : RMCP+
<<   Payload type            : IPMI (0)
<<   Session ID              : 0xa0a2a3a4
<<   Sequence                : 0x00000002
<<   IPMI Msg/Payload Length : 8
<< IPMI Response Message Header
<<   Rq Addr    : 81
<<   NetFn      : 2d
<<   Rq LUN     : 0
<<   Rs Addr    : 20
<<   Rq Seq     : 02
<<   Rs Lun     : 0
<<   Command    : 3e
<<   Compl Code : 0xc1
IPMI Request Match found
removed list entry seq=0x02 cmd=0x3e
IPM Controller is not HPM.2 compatible

>> Sending IPMI command payload
>>    netfn   : 0x06
>>    command : 0x01
>>    data    : 

BUILDING A v2 COMMAND
added list entry seq=0x03 cmd=0x01
Local RqAddr 0x20 transit 0:0 target 0x20:0 bridgePossible 1
authcode input (24 bytes)
 06 40 82 06 00 00 05 00 00 00 07 00 20 18 c8 81
 0c 01 72 ff ff ff 03 07
authcode output (12 bytes)
 ce c3 11 ec 31 e5 35 81 ff 79 25 fd
>> sending packet (40 bytes)
 06 00 ff 07 06 40 82 06 00 00 05 00 00 00 07 00
 20 18 c8 81 0c 01 72 ff ff ff 03 07 ce c3 11 ec
 31 e5 35 81 ff 79 25 fd
<< received packet (56 bytes)
 06 00 ff 07 06 40 a4 a3 a2 a0 03 00 00 00 17 00
 81 1c 63 20 0c 01 00 00 03 09 08 02 9f 91 12 00
 02 0f 00 00 00 00 6a ff ff ff 03 07 a2 dd b0 7c
 41 ce ef 78 74 13 54 1d
Validating authcode
K1 (20 bytes)
 65 18 bc 15 d1 20 9c 49 77 79 a0 83 61 c1 15 58
 39 bd f1 74
Authcode Input Data (40 bytes)
 06 40 a4 a3 a2 a0 03 00 00 00 17 00 81 1c 63 20
 0c 01 00 00 03 09 08 02 9f 91 12 00 02 0f 00 00
 00 00 6a ff ff ff 03 07
Generated authcode (20 bytes)
 a2 dd b0 7c 41 ce ef 78 74 13 54 1d 1d 81 c0 58
 c7 4d 49 0f
Expected authcode (12 bytes)
 a2 dd b0 7c 41 ce ef 78 74 13 54 1d
<< IPMI Response Session Header
<<   Authtype                : RMCP+
<<   Payload type            : IPMI (0)
<<   Session ID              : 0xa0a2a3a4
<<   Sequence                : 0x00000003
<<   IPMI Msg/Payload Length : 23
<< IPMI Response Message Header
<<   Rq Addr    : 81
<<   NetFn      : 07
<<   Rq LUN     : 0
<<   Rs Addr    : 20
<<   Rq Seq     : 03
<<   Rs Lun     : 0
<<   Command    : 01
<<   Compl Code : 0x00
IPMI Request Match found
removed list entry seq=0x03 cmd=0x01
Iana: 4753
Running Get PICMG Properties my_addr 0x20, transit 0, target 0x20

>> Sending IPMI command payload
>>    netfn   : 0x2c
>>    command : 0x00
>>    data    : 0x00 

BUILDING A v2 COMMAND
added list entry seq=0x04 cmd=0x00
Local RqAddr 0x20 transit 0:0 target 0x20:0 bridgePossible 1
authcode input (24 bytes)
 06 40 82 06 00 00 06 00 00 00 08 00 20 b0 30 81
 10 00 00 6f ff ff 02 07
authcode output (12 bytes)
 2a 4e 2e f5 8d 10 c0 4a 29 35 d2 d6
>> sending packet (40 bytes)
 06 00 ff 07 06 40 82 06 00 00 06 00 00 00 08 00
 20 b0 30 81 10 00 00 6f ff ff 02 07 2a 4e 2e f5
 8d 10 c0 4a 29 35 d2 d6
<< received packet (40 bytes)
 06 00 ff 07 06 40 a4 a3 a2 a0 04 00 00 00 08 00
 81 b4 cb 20 10 00 c1 0f ff ff 02 07 cb f6 8c ca
 2b 9c 8b b0 12 43 28 f3
Validating authcode
K1 (20 bytes)
 65 18 bc 15 d1 20 9c 49 77 79 a0 83 61 c1 15 58
 39 bd f1 74
Authcode Input Data (24 bytes)
 06 40 a4 a3 a2 a0 04 00 00 00 08 00 81 b4 cb 20
 10 00 c1 0f ff ff 02 07
Generated authcode (20 bytes)
 cb f6 8c ca 2b 9c 8b b0 12 43 28 f3 46 07 fe 70
 2a aa 74 b8
Expected authcode (12 bytes)
 cb f6 8c ca 2b 9c 8b b0 12 43 28 f3
<< IPMI Response Session Header
<<   Authtype                : RMCP+
<<   Payload type            : IPMI (0)
<<   Session ID              : 0xa0a2a3a4
<<   Sequence                : 0x00000004
<<   IPMI Msg/Payload Length : 8
<< IPMI Response Message Header
<<   Rq Addr    : 81
<<   NetFn      : 2d
<<   Rq LUN     : 0
<<   Rs Addr    : 20
<<   Rq Seq     : 04
<<   Rs Lun     : 0
<<   Command    : 00
<<   Compl Code : 0xc1
IPMI Request Match found
removed list entry seq=0x04 cmd=0x00
Error response 0xc1 from Get PICMG Properities
Running Get VSO Capabilities my_addr 0x20, transit 0, target 0x20

>> Sending IPMI command payload
>>    netfn   : 0x2c
>>    command : 0x00
>>    data    : 0x03 

BUILDING A v2 COMMAND
added list entry seq=0x05 cmd=0x00
Local RqAddr 0x20 transit 0:0 target 0x20:0 bridgePossible 1
authcode input (24 bytes)
 06 40 82 06 00 00 07 00 00 00 08 00 20 b0 30 81
 14 00 03 68 ff ff 02 07
authcode output (12 bytes)
 93 4d 7b fb c8 c0 5b 2b 11 82 e1 14
>> sending packet (40 bytes)
 06 00 ff 07 06 40 82 06 00 00 07 00 00 00 08 00
 20 b0 30 81 14 00 03 68 ff ff 02 07 93 4d 7b fb
 c8 c0 5b 2b 11 82 e1 14
<< received packet (40 bytes)
 06 00 ff 07 06 40 a4 a3 a2 a0 05 00 00 00 08 00
 81 b4 cb 20 14 00 c1 0b ff ff 02 07 73 16 70 fe
 2b e6 ac 88 ed 34 24 7c
Validating authcode
K1 (20 bytes)
 65 18 bc 15 d1 20 9c 49 77 79 a0 83 61 c1 15 58
 39 bd f1 74
Authcode Input Data (24 bytes)
 06 40 a4 a3 a2 a0 05 00 00 00 08 00 81 b4 cb 20
 14 00 c1 0b ff ff 02 07
Generated authcode (20 bytes)
 73 16 70 fe 2b e6 ac 88 ed 34 24 7c 43 ce be 94
 2b 13 48 c2
Expected authcode (12 bytes)
 73 16 70 fe 2b e6 ac 88 ed 34 24 7c
<< IPMI Response Session Header
<<   Authtype                : RMCP+
<<   Payload type            : IPMI (0)
<<   Session ID              : 0xa0a2a3a4
<<   Sequence                : 0x00000005
<<   IPMI Msg/Payload Length : 8
<< IPMI Response Message Header
<<   Rq Addr    : 81
<<   NetFn      : 2d
<<   Rq LUN     : 0
<<   Rs Addr    : 20
<<   Rq Seq     : 05
<<   Rs Lun     : 0
<<   Command    : 00
<<   Compl Code : 0xc1
IPMI Request Match found
removed list entry seq=0x05 cmd=0x00
Invalid completion code received: Invalid command
Acquire IPMB address
Discovered IPMB address 0x0
Interface address: my_addr 0x20 transit 0:0 target 0x20:0 ipmb_target 0


>> Sending IPMI command payload
>>    netfn   : 0x00
>>    command : 0x01
>>    data    : 

BUILDING A v2 COMMAND
added list entry seq=0x06 cmd=0x01
Local RqAddr 0x20 transit 0:0 target 0x20:0 bridgePossible 1
authcode input (24 bytes)
 06 40 82 06 00 00 08 00 00 00 07 00 20 00 e0 81
 18 01 66 ff ff ff 03 07
authcode output (12 bytes)
 a7 7d 18 08 25 3b 37 2f 42 5f c4 6a
>> sending packet (40 bytes)
 06 00 ff 07 06 40 82 06 00 00 08 00 00 00 07 00
 20 00 e0 81 18 01 66 ff ff ff 03 07 a7 7d 18 08
 25 3b 37 2f 42 5f c4 6a
<< received packet (44 bytes)
 06 00 ff 07 06 40 a4 a3 a2 a0 06 00 00 00 0b 00
 81 04 7b 20 18 01 00 01 00 00 c6 ff ff ff 03 07
 86 87 98 fa 70 35 87 15 34 74 72 00
Validating authcode
K1 (20 bytes)
 65 18 bc 15 d1 20 9c 49 77 79 a0 83 61 c1 15 58
 39 bd f1 74
Authcode Input Data (28 bytes)
 06 40 a4 a3 a2 a0 06 00 00 00 0b 00 81 04 7b 20
 18 01 00 01 00 00 c6 ff ff ff 03 07
Generated authcode (20 bytes)
 86 87 98 fa 70 35 87 15 34 74 72 00 dd ca 55 07
 b1 e0 b3 31
Expected authcode (12 bytes)
 86 87 98 fa 70 35 87 15 34 74 72 00
<< IPMI Response Session Header
<<   Authtype                : RMCP+
<<   Payload type            : IPMI (0)
<<   Session ID              : 0xa0a2a3a4
<<   Sequence                : 0x00000006
<<   IPMI Msg/Payload Length : 11
<< IPMI Response Message Header
<<   Rq Addr    : 81
<<   NetFn      : 01
<<   Rq LUN     : 0
<<   Rs Addr    : 20
<<   Rq Seq     : 06
<<   Rs Lun     : 0
<<   Command    : 01
<<   Compl Code : 0x00
IPMI Request Match found
removed list entry seq=0x06 cmd=0x01

>> Sending IPMI command payload
>>    netfn   : 0x06
>>    command : 0x3c
>>    data    : 0x82 0x06 0x00 0x00 

BUILDING A v2 COMMAND
added list entry seq=0x07 cmd=0x3c
Local RqAddr 0x20 transit 0:0 target 0x20:0 bridgePossible 0
authcode input (28 bytes)
 06 40 82 06 00 00 09 00 00 00 0b 00 20 18 c8 81
 1c 3c 82 06 00 00 9f ff ff ff 03 07
authcode output (12 bytes)
 ab 5c d9 d1 57 07 e4 bf dd ca b6 be
>> sending packet (44 bytes)
 06 00 ff 07 06 40 82 06 00 00 09 00 00 00 0b 00
 20 18 c8 81 1c 3c 82 06 00 00 9f ff ff ff 03 07
 ab 5c d9 d1 57 07 e4 bf dd ca b6 be
<< received packet (40 bytes)
 06 00 ff 07 06 40 a4 a3 a2 a0 07 00 00 00 08 00
 81 1c 63 20 1c 3c 00 88 ff ff 02 07 c8 61 4f fe
 fd 98 a5 b0 7c 2c d4 81
Validating authcode
K1 (20 bytes)
 65 18 bc 15 d1 20 9c 49 77 79 a0 83 61 c1 15 58
 39 bd f1 74
Authcode Input Data (24 bytes)
 06 40 a4 a3 a2 a0 07 00 00 00 08 00 81 1c 63 20
 1c 3c 00 88 ff ff 02 07
Generated authcode (20 bytes)
 c8 61 4f fe fd 98 a5 b0 7c 2c d4 81 12 bf 77 14
 5a f0 91 f6
Expected authcode (12 bytes)
 c8 61 4f fe fd 98 a5 b0 7c 2c d4 81
<< IPMI Response Session Header
<<   Authtype                : RMCP+
<<   Payload type            : IPMI (0)
<<   Session ID              : 0xa0a2a3a4
<<   Sequence                : 0x00000007
<<   IPMI Msg/Payload Length : 8
<< IPMI Response Message Header
<<   Rq Addr    : 81
<<   NetFn      : 07
<<   Rq LUN     : 0
<<   Rs Addr    : 20
<<   Rq Seq     : 07
<<   Rs Lun     : 0
<<   Command    : 3c
<<   Compl Code : 0x00
IPMI Request Match found
removed list entry seq=0x07 cmd=0x3c
Closed Session 00000682

